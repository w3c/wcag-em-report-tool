"use strict";angular.module("wcagReporter",["ngResource","ngSanitize","ngRoute","ngAnimate","pascalprecht.translate","wert-templates"]).config(["$routeProvider","$compileProvider",function(e,t){t.aHrefSanitizationWhitelist(/^\s*(https?|data|blob):/),e.when("/",{templateUrl:"views/start.html",controller:"StartCtrl"}).when("/evaluation/scope",{templateUrl:"views/evaluation/scope.html",controller:"EvalScopeCtrl"}).when("/evaluation/explore",{templateUrl:"views/evaluation/explore.html",controller:"EvalExploreCtrl"}).when("/evaluation/sample",{templateUrl:"views/evaluation/sample.html",controller:"EvalSampleCtrl"}).when("/evaluation/audit",{templateUrl:"views/evaluation/audit.html",controller:"EvalAuditCtrl"}).when("/evaluation/report",{templateUrl:"views/evaluation/report.html",controller:"EvalReportCtrl"}).when("/view_report",{templateUrl:"views/viewReport.html",controller:"ViewReportCtrl"}).when("/open",{templateUrl:"views/open.html",controller:"OpenCtrl"}).when("/save",{templateUrl:"views/save.html",controller:"SaveCtrl"}).when("/error",{templateUrl:"views/error.html"}).when("/import",{templateUrl:"views/import.html",controller:"ImportCtrl"}).otherwise({redirectTo:"/error"})}]),angular.module("wcagReporter").value("supportedLanguages",[{code:"en",localName:"English"},{code:"nl",localName:"Nederlands"}]).config(["$translateProvider","wcag2specProvider",function(e,t){var r,n,o;try{(r=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}("wcagReporter-lang"))||(r=(r=jQuery('*[ng-app="wcagReporter"]').attr("lang")||"en").substr(0,2),n="wcagReporter-lang",o=r,document.cookie=n+"="+o+"; path=/")}catch(e){r="en"}e.useSanitizeValueStrategy(null),e.useStaticFilesLoader({prefix:"locale/",suffix:".json"}),t.setSpecPath("wcag2spec/wcag2-${lang}.json"),t.loadLanguage(r),e.preferredLanguage(r)}]).run(["$rootScope","$rootElement","translateFilter",function(r,n,e){r.translate=e,n.addClass("app-loading"),r.$on("$translateChangeSuccess",function(e,t){n.attr("lang",t.language),r.lang=t.language,n.removeClass("app-loading")})}]),angular.module("wcagReporter").run(["$rootScope","$document","$rootElement","evalScopeModel",function(r,e,t,n){var o,a=e.find("title"),i=a.text().trim();i=i&&a.text()+", ",r.focusH1=function(){var e=t.find("h1:first()").attr({tabindex:-1,role:"heading"});setTimeout(function(){e.focus()},10)},r.setTitle=function(e){var t="";return n.website&&n.website.title&&(t=n.website.title+" - "),a.text(i+t+e),!0===o&&(o=!1,setTimeout(r.focusH1,750)),e},r.$on("$routeChangeSuccess",function(){o=void 0!==o,document.activeElement&&document.activeElement.blur()})}]).run(["$rootScope","appState","$location",function(e,t,r){e.rootHide={},t.init(),e.setEvalLocation=function(){t.setDirtyState(),r.path("/evaluation/scope")},e.support={hasSupport:t.hasBrowserSupport(),hideMessage:!1}}]).run(["$rootElement","wcagReporterExport","showSave","appState",function(e,t,r,n){r&&e.on("keydown",function(e){83===e.keyCode&&(e.ctrlKey||e.metaKey)&&(r(t.getString(),t.getFileName(),"application/json"),n.setPrestineState(),e.preventDefault())});var o=new RegExp("/"+window.location.host+"/");e.on("click","a[href]:not(.local)",function(e){o.test(this.href)||"http"!==this.href.substr(0,4)||(e.preventDefault(),e.stopPropagation(),window.open(this.href,"_blank"))})}]).run(["wcagReporterImport","wcagReporterExport","$rootElement",function(e,t,r){t.storage.init({autosave:"string"==typeof r.attr("autosave"),url:r.attr("url"),saveDelay:r.attr("save-delay")||1500}),r.attr("url")&&e.getFromUrl()}]),angular.module("wcagReporter").value("pkgData",{name:"WCAG-EM-Report-Tool",version:"2.0.0",buildDate:"2020-1-6"}),angular.module("wcagReporter").value("toggleCriterionText",function(e){var t=-1!==[!0,"true"].indexOf(e.getAttribute("aria-expanded"));e.setAttribute("aria-expanded",!t),e.parentNode.parentNode.nextSibling.classList.toggle("collapsed")}),angular.module("wcagReporter").factory("directivePlugin",function(){return function(e){var r=e.link||function(){};return e.plugins||(e.plugins=[]),e.link=function(){var t=arguments;r.apply(void 0,t),e.plugins.forEach(function(e){e.link&&e.link.apply(void 0,t)})},e}}),angular.module("wcagReporter").service("changeLanguage",["$translate","wcag2spec","$rootScope",function(t,r,n){return function(e){n.lang!==e&&(document&&function(e,t){document.cookie=e+"="+t+"; path=/"}("wcagReporter-lang",e),t.use(e),r.loadLanguage(e))}}]),angular.module("wcagReporter").constant("evalContextV1",{"@vocab":"http://www.w3.org/TR/WCAG-EM/#",wcag20:"http://www.w3.org/TR/WCAG20/#",earl:"http://www.w3.org/ns/earl#",dct:"http://purl.org/dc/terms/",reporter:"https://github.com/w3c/wcag-em-report-tool/blob/master/dataformat.md#",conformanceTarget:{id:"step1b",type:"id"},evaluationScope:{id:"step1"},accessibilitySupportBaseline:{id:"step1c"},additionalEvalRequirement:{id:"step1d"},siteScope:{id:"step1a"},commonPages:{id:"step2a"},essentialFunctionality:{id:"step2b"},pageTypeVariety:{id:"step2c"},otherRelevantPages:{id:"step2e"},structuredSample:{id:"step3a"},randomSample:{id:"step3b"},specifics:{id:"step5b"},auditResult:{id:"step4"},outcome:{type:"id"},subject:{type:"id"},assertedBy:{type:"id"},testRequirement:{type:"id"},creator:{type:"id"},handle:"reporter:handle",description:"reporter:description",tested:"reporter:tested",id:"@id",type:"@type",title:"dct:title",hasPart:"dct:hasPart",specs:"@id",reliedUponTechnology:"wcag20:reliedupondef"}),angular.module("wcagReporter").constant("evalContextV2",{"@vocab":"http://www.w3.org/TR/WCAG-EM/#",reporter:"https://github.com/w3c/wcag-em-report-tool/",wcagem:"http://www.w3.org/TR/WCAG-EM/#",WCAG2:"http://www.w3.org/TR/WCAG20/#",earl:"http://www.w3.org/ns/earl#",dct:"http://purl.org/dc/terms/",wai:"http://www.w3.org/WAI/",sch:"http://schema.org/",Evaluation:"wcagem:Evaluation",EvaluationScope:"wcagem:EvaluationScope",TestSubject:"earl:TestSubject",WebSite:"sch:WebSite",Sample:"wcagem:Sample",WebPage:"sch:WebPage",Technology:"WCAG2:technologydef",Assertion:"earl:Assertion",Assertor:"earl:Assertor",TestResult:"earl:TestResult",title:"dct:title",summary:"dct:summary",creator:{"@id":"dct:creator","@type":"@id"},date:"dct:date",commissioner:"wcagem:commissioner",reliedUponTechnology:"WCAG2:reliedupondef",evaluationScope:"step1",commonPages:"step2a",essentialFunctionality:"step2b",pageTypeVariety:"step2c",otherRelevantPages:"step2e",structuredSample:"step3a",randomSample:"step3b",auditResult:"step4",specifics:"step5b",publisher:{"@id":"dct:publisher","@type":"@id"},conformanceTarget:{"@id":"step1b","@type":"@id"},accessibilitySupportBaseline:"step1c",additionalEvalRequirement:"step1d",website:"WCAG2:set-of-web-pagesdef",siteScope:"step1a",siteName:"sch:name",webpage:"WCAG2:webpagedef",description:"dct:description",source:{"@id":"dct:source","@type":"@id"},tested:"reporter:blob/master/docs/EARL%2BJSON-LD.md#tested",test:{"@id":"earl:test","@type":"@id"},assertedBy:{"@id":"earl:assertedBy","@type":"@id"},subject:{"@id":"earl:subject","@type":"@id"},result:"earl:result",mode:{"@id":"earl:mode","@type":"@id"},hasPart:"dct:hasPart",outcome:{"@id":"earl:outcome","@type":"@id"},id:"@id",type:"@type",lang:"@language"}),angular.module("wcagReporter").constant("evalContextV3",{"@vocab":"http://www.w3.org/TR/WCAG-EM/#",reporter:"https://github.com/w3c/wcag-em-report-tool/",wcagem:"http://www.w3.org/TR/WCAG-EM/#",WCAG2:"http://www.w3.org/TR/WCAG21/#",earl:"http://www.w3.org/ns/earl#",dct:"http://purl.org/dc/terms/",wai:"http://www.w3.org/WAI/",sch:"http://schema.org/",Evaluation:"wcagem:Evaluation",EvaluationScope:"wcagem:EvaluationScope",TestSubject:"earl:TestSubject",WebSite:"sch:WebSite",Sample:"wcagem:Sample",WebPage:"sch:WebPage",Technology:"WCAG2:dfn-technologies",Assertion:"earl:Assertion",Assertor:"earl:Assertor",TestResult:"earl:TestResult",title:"dct:title",summary:"dct:summary",creator:{"@id":"dct:creator","@type":"@id"},date:"dct:date",commissioner:"wcagem:commissioner",reliedUponTechnology:"WCAG2:dfn-relied-upon",evaluationScope:"step1",commonPages:"step2a",essentialFunctionality:"step2b",pageTypeVariety:"step2c",otherRelevantPages:"step2e",structuredSample:"step3a",randomSample:"step3b",auditResult:"step4",specifics:"step5b",publisher:{"@id":"dct:publisher","@type":"@id"},conformanceTarget:{"@id":"step1b","@type":"@id"},accessibilitySupportBaseline:"step1c",additionalEvalRequirement:"step1d",website:"WCAG2:dfn-set-of-web-pages",siteScope:"step1a",siteName:"sch:name",webpage:"WCAG2:dfn-web-page-s",description:"dct:description",source:{"@id":"dct:source","@type":"@id"},tested:"reporter:blob/master/docs/EARL%2BJSON-LD.md#tested",test:{"@id":"earl:test","@type":"@id"},assertedBy:{"@id":"earl:assertedBy","@type":"@id"},subject:{"@id":"earl:subject","@type":"@id"},result:"earl:result",mode:{"@id":"earl:mode","@type":"@id"},hasPart:"dct:hasPart",outcome:{"@id":"earl:outcome","@type":"@id"},id:"@id",type:"@type",lang:"@language"}),angular.module("wcagReporter").constant("knownTech",[{title:"HTML5",id:"http://www.w3.org/TR/html5/",type:"Technology"},{title:"XHTML 1.0",id:"http://www.w3.org/TR/xhtml1/",type:"Technology"},{title:"HTML 4.01",id:"http://www.w3.org/TR/html401/",type:"Technology"},{title:"CSS",id:"http://www.w3.org/Style/CSS/specs/",type:"Technology"},{title:"WAI-ARIA",id:"http://www.w3.org/TR/wai-aria/",type:"Technology"},{title:"ECMAScript 3",id:"http://www.ecma-international.org/publications/standards/Ecma-327.htm",type:"Technology"},{title:"ECMAScript 5",id:"http://www.ecma-international.org/publications/standards/Ecma-262.htm",type:"Technology"},{title:"DOM",id:"http://www.w3.org/DOM/",type:"Technology"},{title:"Flash",id:"http://get.adobe.com/nl/flashplayer/",type:"Technology"},{title:"Silverlight",id:"http://www.microsoft.com/silverlight/",type:"Technology"},{title:"OOXML",id:"http://www.ecma-international.org/publications/standards/Ecma-376.htm",type:"Technology"},{title:"ODF 1.2",id:"https://www.oasis-open.org/standards#opendocumentv1.2",type:"Technology"},{title:"SVG",id:"http://www.w3.org/TR/SVG/",type:"Technology"}]),angular.module("wcagReporter").service("reportStorage",["$http","$rootScope","appState","$timeout",function(t,e,r,n){var o,a,i,s=0,l={url:void 0,revisionId:void 0,autosave:!1,saveDelay:3e3};function c(){l.url?a=n(function e(){o.exportModel.saveToUrl().then(function(){s=0},function(){s+=1,l.autosave&&(a=n(e,l.saveDelay*s,0,!1))})},l.saveDelay,0,!1):l.autosave=!1}return e.$on("appstate:prestine",function(){a&&(n.cancel(a),a=void 0)}),e.$on("appstate:dirty",function(){l.autosave&&void 0===a&&c()}),o={settings:l,exportModel:void 0,init:function(e){o.updateSettings(e)},updateSettings:function(e){e&&angular.extend(l,e),l.autosave&&i?i.then(c):l.autosave&&c()},post:function(e){return l.revisionId&&(e._rev=l.revisionId),t.put(l.url,e,{},{withCredentials:!0}).then(function(e){return e&&e.data&&e.data.rev&&(l.revisionId=e.data.rev),r.setPrestineState(),e.data})},get:function(){return n.cancel(a),i=t.get(l.url,{},{withCredentials:!0}).then(function(e){return e.data._rev&&(l.revisionId=e.data._rev),r.setPrestineState(),e.data})}}}]),angular.module("wcagReporter").service("evalLoader",["evalWindow","appState","fileReader","wcagReporterImport","$q",function(a,i,t,e,s){function r(n){var o;return function(){var e=n.apply(null,arguments),t=s.defer();function r(e){t.reject(e),o&&o.abort()}if(i.empty)o=a;else try{o=a.openEmptyWindow()}catch(e){r("Popup blocker detected. Please allow popups so the evaluation can open in a new window.")}return e.then(function(e){try{o.loadJson(e),i.setDirtyState(),t.resolve()}catch(e){r(e)}},r),t.promise}}return{openFromFile:r(function(e){return t.readAsText(e)}),openFromUrl:r(function(){return e.getFromUrl()})}}]),angular.module("wcagReporter").service("evalWindow",["$http","wcagReporterImport","$rootScope",function(e,t,r){var n,o="waitingForEvaluation",a="loadEvaluationData",i="evaluateDataWhenReady";function s(){}function l(e){n.loadJson(e),r.setEvalLocation()}return s.prototype={openEmptyWindow:function(){var e=new s,t=window.open(window.location.href,"_blank");return t[o]=!0,e.abort=function(){t.close()},e.loadJson=function(e){t[a]?t[a](e):t[i]=e},e},loadJson:function(e){t.fromJson(e)},abort:angular.noop},n=new s,window[o]&&(window[o]=void 0,window[i]?l(window[i]):window[a]=l),n}]),angular.module("wcagReporter").factory("fileReader",["$q","$rootScope",function(o,a){function i(e,t){var r=new FileReader;return r.onload=function(e,t,r){return function(){r.$apply(function(){t.resolve(e.result)})}}(r,e,t),r.onerror=function(e,t,r){return function(){r.$apply(function(){t.reject(e.result)})}}(r,e,t),r.onprogress=function(e,t){return function(e){t.$broadcast("fileProgress",{total:e.total,loaded:e.loaded})}}(0,t),r}return{readAsDataUrl:function(e,t){t=t||a;var r=o.defer(),n=i(r,t);return t.$evalAsync(function(){try{n.readAsDataURL(e)}catch(e){r.reject(e)}}),r.promise},readAsText:function(e,t){t=t||a;var r=o.defer(),n=i(r,t);return t.$evalAsync(function(){try{n.readAsText(e)}catch(e){r.reject(e)}}),r.promise}}}]),angular.module("wcagReporter").service("showSave",function(){var e,s="application/octet-stream",l="download"in document.createElement("a"),c=window.Blob,u=window.URL||window.webkitURL||window.mozURL||window.msURL;navigator.saveBlob=navigator.saveBlob||navigator.msSaveBlob||navigator.mozSaveBlob||navigator.webkitSaveBlob,window.saveAs=window.saveAs||window.webkitSaveAs||window.mozSaveAs||window.msSaveAs;var p={"image/jpeg":!0,"image/png":!0,"image/gif":!0,"image/svg+xml":!0,"image/bmp":!0,"image/x-windows-bmp":!0,"image/webp":!0,"audio/wav":!0,"audio/mpeg":!0,"audio/webm":!0,"audio/ogg":!0,"video/mpeg":!0,"video/webm":!0,"video/ogg":!0,"text/plain":!0,"text/html":!0,"text/xml":!0,"application/xhtml+xml":!0,"application/json":!0};return c&&(window.saveAs||navigator.saveBlob)?e=function(e,t,r){var n=new c([e],{type:r||s});t=t||"Download.bin",window.saveAs?window.saveAs(n,t):navigator.saveBlob(n,t)}:c&&u?e=function(e,t,r){var n,o;if(l){o=new c([e],{type:r||s}),n=u.createObjectURL(o);var a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",t||"Download.bin");var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(i)}else!0===p[r.split(";")[0]]&&(r=s),o=new c([e],{type:r||s}),n=u.createObjectURL(o),window.open(n,"_blank","");setTimeout(function(){u.revokeObjectURL(n)},250)}:/\bMSIE\b/.test(navigator.userAgent)||(e=function(e,t,r){!0===p[(r=r||s).split(";")[0]]&&(r=s),window.open("data:"+r+","+encodeURIComponent(e),"_blank","")}),e}),angular.module("wcagReporter").constant("wcagSpecIdMap",[["text-equiv-all","non-text-content"],["media-equiv-av-only-alt","audio-only-and-video-only-prerecorded"],["media-equiv-captions","captions-prerecorded"],["media-equiv-audio-desc","audio-description-or-media-alternative-prerecorded"],["media-equiv-real-time-captions","captions-live"],["media-equiv-audio-desc-only","audio-description-prerecorded"],["media-equiv-sign","sign-language-prerecorded"],["media-equiv-extended-ad","extended-audio-description-prerecorded"],["media-equiv-text-doc","media-alternative-prerecorded"],["media-equiv-live-audio-only","audio-only-live"],["content-structure-separation-programmatic","info-and-relationships"],["content-structure-separation-sequence","meaningful-sequence"],["content-structure-separation-understanding","sensory-characteristics"],["","orientation"],["","identify-input-purpose"],["","identify-purpose"],["visual-audio-contrast-without-color","use-of-color"],["visual-audio-contrast-dis-audio","audio-control"],["visual-audio-contrast-contrast","contrast-minimum"],["visual-audio-contrast-scale","resize-text"],["visual-audio-contrast-text-presentation","images-of-text"],["visual-audio-contrast7","contrast-enhanced"],["visual-audio-contrast-noaudio","low-or-no-background-audio"],["visual-audio-contrast-visual-presentation","visual-presentation"],["visual-audio-contrast-text-images","images-of-text-no-exception"],["","reflow"],["","non-text-contrast"],["","text-spacing"],["","content-on-hover-or-focus"],["keyboard-operation-keyboard-operable","keyboard"],["keyboard-operation-trapping","no-keyboard-trap"],["keyboard-operation-all-funcs","keyboard-no-exception"],["","character-key-shortcuts"],["time-limits-required-behaviors","timing-adjustable"],["time-limits-pause","pause-stop-hide"],["time-limits-no-exceptions","no-timing"],["time-limits-postponed","interruptions"],["time-limits-server-timeout","re-authenticating"],["","timeouts"],["seizure-does-not-violate","three-flashes-or-below-threshold"],["seizure-three-times","three-flashes"],["","animation-from-interactions"],["navigation-mechanisms-skip","bypass-blocks"],["navigation-mechanisms-title","page-titled"],["navigation-mechanisms-focus-order","focus-order"],["navigation-mechanisms-refs","link-purpose-in-context"],["navigation-mechanisms-mult-loc","multiple-ways"],["navigation-mechanisms-descriptive","headings-and-labels"],["navigation-mechanisms-focus-visible","focus-visible"],["navigation-mechanisms-location","location"],["navigation-mechanisms-link","link-purpose-link-only"],["navigation-mechanisms-headings","section-headings"],["","pointer-gestures"],["","pointer-cancellation"],["","label-in-name"],["","motion-actuation"],["","target-size"],["","concurrent-input-mechanisms"],["meaning-doc-lang-id","language-of-page"],["meaning-other-lang-id","language-of-parts"],["meaning-idioms","unusual-words"],["meaning-located","abbreviations"],["meaning-supplements","reading-level"],["meaning-pronunciation","pronunciation"],["consistent-behavior-receive-focus","on-focus"],["consistent-behavior-unpredictable-change","on-input"],["consistent-behavior-consistent-locations","consistent-navigation"],["consistent-behavior-consistent-functionality","consistent-identification"],["consistent-behavior-no-extreme-changes-context","change-on-request"],["minimize-error-identified","error-identification"],["minimize-error-cues","labels-or-instructions"],["minimize-error-suggestions","error-suggestion"],["minimize-error-reversible","error-prevention-legal-financial-data"],["minimize-error-context-help","help"],["minimize-error-reversible-all","error-prevention-all"],["ensure-compat-parses","parsing"],["ensure-compat-rsv","name-role-value"],["","status-messages"]]),angular.module("wcagReporter").constant("types",{EARL:{type:"earl",MODE:{type:"earl:TestMode",MANUAL:"earl:manual"},OUTCOME:{type:"earl:OutcomeValue",CANNOT_TELL:"earl:CannotTell",CANT_TELL:"earl:cantTell",INAPPLICABLE:"earl:inapplicable",FAIL:"earl:Fail",FAILED:"earl:failed",NOT_APPLICABLE:"earl:NotApplicable",NOT_TESTED:"earl:NotTested",PASS:"earl:Pass",PASSED:"earl:passed",UNTESTED:"earl:untested"},RESULT:{class:"TestResult",type:"earl:TestResult"}}}),angular.module("wcagReporter").service("isObjectLiteral",function(){return function(e){return"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)}}),angular.module("wcagReporter").directive("criterionBody",["directivePlugin","evalSampleModel","selectedCasesOnlyFilter",function(e,n,o){function t(e){var r=n.getFilledPages(),t=e.criterion.getSinglePageAsserts();return e.opt.editable?o(t).sort(function(e,t){return r.indexOf(e.subject[0])-r.indexOf(t.subject[0])}):t.filter(function(e){return e.isDefined()}).sort(function(e,t){return r.indexOf(e.subject[0])-r.indexOf(t.subject[0])})}return e({restrict:"E",replace:!0,transclude:!0,scope:{criterion:"=assert",opt:"=options"},controller:["$scope",function(e){e.opt.editable&&e.criterion.setCaseForEachPage(),e.$on("audit:sample-change",function(){e.multiPageAsserts=e.criterion.getMultiPageAsserts(),e.singlePageAsserts=t(e)})}],link:function(e){e.showBody=function(){return 0<e.multiPageAsserts.length||0<e.singlePageAsserts.length||e.opt.editable},e.multiPageAsserts=e.criterion.getMultiPageAsserts(),e.singlePageAsserts=t(e),e.hasMultipage=!1,e.addMultiPage=function(){e.criterion.addTestCaseAssertion({multiPage:!0,subject:n.getSelectedPages()}),e.multiPageAsserts=e.criterion.getMultiPageAsserts()}},templateUrl:"views/directives/criterion/criterionBody.html"})}]),angular.module("wcagReporter").directive("earlAssert",["$filter","directivePlugin","CriterionAssert","$rootScope",function(t,e,r,n){return e({restrict:"E",replace:!0,transclude:!0,scope:{opt:"=options",assert:"="},link:function(e){e.result=e.assert.result,e.outcomes=["earl:untested","earl:passed","earl:failed","earl:inapplicable","earl:cantTell"].map(function(e){return{id:e,name:t("rdfToLabel")(e)}}),e.updateMetadata=function(){r.updateMetadata(e.assert)},e.getStaticHtmlResult=function(e){return e=(""+e).trim()||"â€“","<p><strong>"+t("translate")("HTML_REPORT.LABEL_DESCR")+":</strong> "+t("txtToHtml")(e).substr(3)},e.htmlResult=e.getStaticHtmlResult(e.result.description)},templateUrl:"views/directives/criterion/earlAssert.html"})}]),angular.module("wcagReporter").directive("macroResults",["directivePlugin",function(e){return e({restrict:"E",replace:!0,scope:{criterion:"=value",asserts:"=",opt:"=options"},link:function(r){r.removeAssert=function(e){var t=r.criterion.hasPart.indexOf(e);0<=t&&r.criterion.hasPart.splice(t,1),0<=(t=r.asserts.indexOf(e))&&r.asserts.splice(t,1)},r.transferMacroData=function(e){r.criterion.transferMacroData(e),r.removeAssert(e)},r.getAllTitles=function(e){return e.subject.map(function(e){return e.displayTitle()}).join(", ")}},templateUrl:"views/directives/criterion/macroResults.html"})}]),angular.module("wcagReporter").directive("pageResults",["directivePlugin",function(e){return e({restrict:"E",replace:!0,scope:{criterion:"=value",asserts:"=",opt:"=options"},link:function(t){t.createMacro=function(e){t.criterion.addTestCaseAssertion({result:{description:e.result.description,outcome:e.result.outcome},multiPage:!0})}},templateUrl:"views/directives/criterion/pageResults.html"})}]),angular.module("wcagReporter").directive("pageSelect",["directivePlugin","evalSampleModel",function(e,t){var n;return e({restrict:"E",replace:!0,scope:{pages:"="},controller:["$scope",function(r){r.updateSampleList=function(){r.unselectedPages=n.filter(function(e){return-1===r.pages.indexOf(e)})},r.removePage=function(e){var t=r.pages.indexOf(e);0<=t&&(r.pages.splice(t,1),r.updateSampleList())},r.addPageToAssert=function(){var e=t.getPageByTitle(r.newPage);e&&-1===r.pages.indexOf(e)&&(r.unselectedPages.splice(r.unselectedPages.indexOf(e),1),r.pages.push(e),r.newPage="")},n=t.getPages(),r.updateSampleList()}],templateUrl:"views/directives/criterion/pageSelect.html"})}]),angular.module("wcagReporter").directive("resultDescription",["directivePlugin",function(e){return e({restrict:"E",replace:!0,scope:{value:"=",updateMetadata:"="},templateUrl:"views/directives/criterion/resultDescription.html"})}]),angular.module("wcagReporter").directive("infoButton",["directivePlugin",function(e){return e({restrict:"E",scope:{label:"@",target:"@"},link:function(e,t){var r;t.on("click",function(){r||(r=void 0===e.target?t.next():angular.element("#"+e.target)).find(".close").on("click",t.attr.bind(t,"aria-expanded",!1)),r.toggle(200,function(){r.focus(),t.attr("aria-expanded",r.is(":visible"))})})},replace:!0,templateUrl:"views/directives/evaluate/infoButton.html"})}]),angular.module("wcagReporter").directive("infoField",["directivePlugin","$document",function(e,o){return e({restrict:"E",scope:{ref:"@",button:"@",exitto:"@"},link:function(r,n){n.hide(0),r.close=function(e){var t;"keyup"===e.type&&13!==e.keyCode&&27!==e.keyCode||(r.exitto&&(t=angular.element("#"+r.exitto)),t&&0!==t.length||(t=function(e){var t=":input:visible, a[href]:visible",r=o.find(t);return e=angular.element(e).closest(".alert-info").find(t).last(),r[r.index(e)+1]}(e.target)),t.focus(),n.hide(200))}},replace:!0,transclude:!0,templateUrl:"views/directives/evaluate/infoField.html"})}]),angular.module("wcagReporter").directive("inputPages",["directivePlugin","$timeout","Page",function(e,o,t){return e({restrict:"E",replace:!0,scope:{pages:"=",addPage:"&",removePage:"&"},link:function(e){var r=e.addPage(),n=e.removePage();e.addPage=function(e){var t=angular.element(e.delegateTarget);r(),o(function(){var e=t.prev().find("input");e[e.length-2].select()},100)},e.processPage=function(e){t.prependProtocol(e),t.updateSource(e)},e.removePage=function(e,t){n(e),o(function(){angular.element(t.delegateTarget).closest("fieldset").parent().children().last().focus()})}},templateUrl:"views/directives/evaluate/inputPages.html"})}]),angular.module("wcagReporter").directive("techSelect",function(){var o=[{title:"HTML5",specs:"http://www.w3.org/TR/html5/"},{title:"CSS",specs:"http://www.w3.org/Style/CSS/specs/"},{title:"HTML 4.01",specs:"http://www.w3.org/TR/html401/"}];function t(t,r,n){o.forEach(function(e){t[r]===e[r]&&(t[n]=e[n])})}return{restrict:"E",replace:!0,scope:{selected:"="},link:function(e){e.technolgies=o,e.updateTitle=function(e){t(e,"specs","title")},e.updateSpec=function(e){t(e,"title","specs")}},templateUrl:"views/directives/evaluate/techSelect.html"}}),angular.module("wcagReporter").directive("iconButton",["directivePlugin",function(e){return e({restrict:"E",replace:!0,scope:{label:"=",icon:"=",click:"&"},templateUrl:"views/directives/evaluate/iconButton.html"})}]),angular.module("wcagReporter").directive("buttonCollapse",["directivePlugin",function(e){return e({restrict:"E",replace:!0,transclude:!0,scope:{obj:"=target",prop:"@property"},link:function(e,t,r){void 0!==r.collapsed&&void 0===e.obj[e.prop]&&(e.obj[e.prop]=!0)},templateUrl:"views/directives/buttonCollapse.html"})}]),angular.module("wcagReporter").directive("fullReport",["directivePlugin","$interval",function(e,o){return e({restrict:"E",replace:!0,link:function(e,t){var r=[".panel-heading",".sample_narrow",".score-total"],n=o(function(){0===(r=r.filter(function(t){return function(e){return 0===t.find(e).length}}(t))).length&&(e.$emit("reportReady",t),o.cancel(n))},200)},templateUrl:"views/directives/fullReport.html"})}]),angular.module("wcagReporter").directive("successCriterion",["directivePlugin","$rootScope","toggleCriterionText",function(e,t,r){var n={"earl:untested":"untested","earl:passed":"passed","earl:failed":"failed","earl:inapplicable":"inapplicable","earl:cantTell":"canttell"};return e({restrict:"E",replace:!0,scope:{assert:"=assertion",spec:"=requirement",opt:"=options"},link:function(e){window.toggleCriterionText=r,e.rootHide=t.rootHide,e.critHide=e.spec.id+"-cb",e.getClassName=function(e){return n[e]}},toggleCriterionText:r,templateUrl:"views/directives/successCriterion.html"})}]),angular.module("wcagReporter").directive("autoResize",["directivePlugin",function(e){return e({restrict:"A",link:function(e,t){e.$evalAsync(function(){angular.element(t).textareaAutoSize()})}})}]),angular.module("wcagReporter").directive("shyPlaceholder",["directivePlugin",function(e){var o="placeholder";return e({restrict:"A",scope:{shyPlaceholder:"="},compile:function(e,n){return function(e,t){var r=e.$eval(n.shyPlaceholder);t.attr(o,r).bind({focus:t.attr.bind(t,o,""),blur:t.attr.bind(t,o,r)})}}})}]),angular.module("wcagReporter").directive("collapse",["$animate",function(l){return{link:function(e,o,t){var a,r=!0;function n(e){var t={};Object.keys(e).forEach(function(e){t[e]=o.css(e)});var r=l.animate(o,t,e);return a&&l.cancel(a),(a=r).then(n,n),r;function n(){a===r&&(a=void 0)}}function i(){o.removeClass("collapsing"),o.addClass("collapse in"),o.css({height:"auto"})}function s(){o.removeClass("collapsing"),o.addClass("collapse")}e.$watch(t.collapse,function(e){e?function(){if(r)r=!1,s(),o.css({height:0});else{o.css({height:o[0].scrollHeight+"px"});o[0].offsetWidth;o.removeClass("collapse in").addClass("collapsing"),n({height:0}).then(s)}}():r?(r=!1,i()):(o.removeClass("collapse").addClass("collapsing"),n({height:o[0].scrollHeight+"px"}).then(i))})}}}]),angular.module("wcagReporter").constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(t){var r=null;this.open=function(e){r||(t.bind("click",n),t.bind("keydown",o)),r&&r!==e&&(r.isOpen=!1),r=e},this.close=function(e){r===e&&(r=null,t.unbind("click",n),t.unbind("keydown",o))};var n=function(e){if(r){var t=r.getToggleElement();e&&t&&t[0].contains(e.target)||r.$apply(function(){r.isOpen=!1})}},o=function(e){27===e.which&&(r.focusToggleElement(),n())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(r,t,n,e,o,a){var i,s=this,l=r.$new(),c=e.openClass,u=angular.noop,p=t.onToggle?n(t.onToggle):angular.noop;this.init=function(e){s.$element=e,t.isOpen&&(i=n(t.isOpen),u=i.assign,r.$watch(i,function(e){l.isOpen=!!e}))},this.toggle=function(e){return l.isOpen=arguments.length?!!e:!l.isOpen},this.isOpen=function(){return l.isOpen},l.getToggleElement=function(){return s.toggleElement},l.focusToggleElement=function(){s.toggleElement&&s.toggleElement[0].focus()},l.$watch("isOpen",function(e,t){a[e?"addClass":"removeClass"](s.$element,c),e?(l.focusToggleElement(),o.open(l)):o.close(l),u(r,e),angular.isDefined(e)&&e!==t&&p(r,{open:!!e})}),r.$on("$locationChangeSuccess",function(){l.isOpen=!1}),r.$on("$destroy",function(){l.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(e,t,r,n){n.init(t)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(t,r,n,o){if(o){o.toggleElement=r;var e=function(e){e.preventDefault(),r.hasClass("disabled")||n.disabled||t.$apply(function(){o.toggle()})};r.bind("click",e),r.attr({"aria-haspopup":!0,"aria-expanded":!1}),t.$watch(o.isOpen,function(e){r.attr("aria-expanded",!!e)}),t.$on("$destroy",function(){r.unbind("click",e)})}}}}),angular.module("wcagReporter").filter("getUrl",function(){var r=/((https?):\/\/)([\da-z\.-]+)\.([a-z\.]{2,6})([\-\w\d@:%_\+.~#?,&\/\/=]+)/g;return function(e){var t;return"string"==typeof e&&(t=e.match(r)),!!t&&t[0]}}),angular.module("wcagReporter").filter("selectedCasesOnly",function(){function t(e){for(var t=0;t<e.subject.length;t++){var r=e.subject[t];if(r.selected&&(r.title||r.description))return!0}return!1}return function(e){if(e)return e.filter(t)}}),angular.module("wcagReporter").filter("rdfToLabel",["$filter",function(t){var e,r={"earl:passed":"PASSED","earl:failed":"FAILED","earl:cantTell":"CANT_TELL","earl:inapplicable":"NOT_PRESENT","earl:untested":"NOT_CHECKED",A:"LEVEL_A",AA:"LEVEL_AA",AAA:"LEVEL_AAA","wai:WCAG2A-Conformance":"LEVEL_A","wai:WCAG2AA-Conformance":"LEVEL_AA","wai:WCAG2AAA-Conformance":"LEVEL_AAA"};return(e=function(e){return t("translate")("EARL."+r[e])}).keymap=r,e.$stateful=!0,e}]),angular.module("wcagReporter").filter("txtToHtml",["$filter",function(r){return function(e){return"string"!=typeof e?"":e.split("\n").reduce(function(e,t){return""===t.trim()?e+"</p><p>":(t=r("linky")(t,"_blank"),e+("<p>"===e.substr(-3)?"":"<br />")+t)},"<p>")+"</p>"}}]),angular.module("wcagReporter").service("appState",["$rootScope","$document","translateFilter",function(e,t,r){var n,o=r("COMMON.WARNING_BEFORE_UNLOAD"),a=window.jQuery(window);function i(){return o}return n={pristine:!0,empty:!0,currentStateIndex:0,maxStateIndex:0,stateList:[{name:"start",route:"/",copmlete:!1},{name:"scope",route:"/evaluation/scope",copmlete:!1},{name:"explore",route:"/evaluation/explore",copmlete:!1},{name:"sample",route:"/evaluation/sample",copmlete:!1},{name:"audit",route:"/evaluation/audit",copmlete:!1},{name:"report",route:"/evaluation/report",copmlete:!1},{name:"viewReport",route:"/view_report",copmlete:!1}],moveToState:function(e){var t,r;for(t=0;t<this.stateList.length;t+=1)if(n.stateList[t].name===e){r=t;break}return n.currentStateIndex=r,n.maxStateIndex<r&&(n.maxStateIndex=r),n},getPreviousState:function(){return n.stateList[n.currentStateIndex-1]},getNextState:function(){return n.stateList[n.currentStateIndex+1]},setPrestineState:function(){n.pristine=!0,a.off("beforeunload",i),t.one("change","input[type=text], textarea, select",n.setDirtyState),e.$emit("appstate:prestine")},setDirtyState:function(){n.pristine&&(e.$emit("appstate:dirty"),a.on("beforeunload",i)),n.pristine=!1,n.empty=!1},init:function(){t.one("change","input[type=text], textarea, select",n.setDirtyState)},hasBrowserSupport:function(){var e=!0;return window.Blob||(console.error("Blob not supported in this browser."),e=!1),window.FileReader||(console.error("FileReader not supported in this browser."),e=!1),window.navigator.msSaveOrOpenBlob||(window.URL||window.webkitURL)&&(window.URL||window.webkitURL).createObjectURL||(console.error("msSaveOrOpenBlob or createObjectURL not supported in this browser."),e=!1),e}}}]),angular.module("wcagReporter").provider("wcag2spec",function(){var r,t,n,o,a=angular.noop,i={},s={};function l(r){return function(e,t){return angular.isArray(e)||(e=e[r]),e.concat(t[r])}}var c={addSpec:function(e,t){e=e.toLowerCase(),s[e]=t,o||c.useLanguage(e)},loadLanguage:function(t){if(t=t.toLowerCase(),"string"!=typeof r)throw new Error("specPath must be defined first");if(s[t])return c.useLanguage(t);var e=r.replace("${lang}",t.toLowerCase());$.getJSON(e).done(function(e){s[t]=e,c.useLanguage(t),a("wcag2spec:load",t)}).fail(console.error.bind(console))},useLanguage:function(e){if(e=e.toLowerCase(),!s[e])throw new Error("Spec for lang "+e+" not defined.");o=s[e],t=o.principles.reduce(l("guidelines"),[]),(n=t.reduce(l("successcriteria"),[])).forEach(function(e){-1!==["A","AA","AAA"].indexOf(e.level)&&(e.level="wai:WCAG2"+e.level+"-Conformance",i[e.id]=e),Object.prototype.hasOwnProperty.call(e,"versions")&&(e.versions=e.versions.map(function(e){return"WCAG"+e.replace(".","")}))}),a("wcag2spec:langChange",e)},getGuidelines:function(){return t},getCriteria:function(){return n},getCriterion:function(e){return i[e]},getPrinciples:function(){return o.principles},isLoaded:function(){return void 0!==o},onLangChange:angular.noop};this.setSpecPath=function(e){r=e},this.loadLanguage=c.loadLanguage,this.$get=["$rootScope",function(n){return a=function(e,t,r){n.$broadcast(e,t,r)},c.onLangChange=function(e){n.$on("wcag2spec:langChange",e)},angular.extend({},c)}]}),angular.module("wcagReporter").service("CriterionAssert",["types","evalSampleModel","$filter","TestCaseAssert","wcag2spec","currentUser",function(n,e,t,o,r,a){function i(e){var t=this;for(var r in i.prototype)this.hasOwnProperty(r)||(this[r]=i.prototype[r]);this.test=e,this.mode=n.EARL.MODE.MANUAL,this.hasPart=[],this.result={type:n.EARL.RESULT.class,outcome:n.EARL.OUTCOME.UNTESTED,description:""},this.getSinglePageAsserts=function(){return t.hasPart.filter(function(e){return!0!==e.multiPage})},this.getMultiPageAsserts=function(){return t.hasPart.filter(function(e){return!0===e.multiPage})},this.addPage=function(e){this.addTestCaseAssertion({subject:[e]})},this.removePage=function(n){var o=this.hasPart;o.map(function(e){return e.subject[0].id});o.forEach(function(e,t){var r=e.subject.indexOf(n);-1!==r&&(e.multiPage?o.subject.splice(r,1):o.splice(t,1))})}}return i.prototype={type:"Assertion",test:void 0,assertedBy:void 0,subject:"_:website",result:void 0,mode:void 0,hasPart:void 0,getSinglePageAsserts:void 0,getMultiPageAsserts:void 0,addTestCaseAssertion:function(e){var t,r=new o;if(r.testcase=this.test,this.hasPart.push(r),e)for(t in e)"subject"===t?r.setSubject(e.subject):r[t]=e[t]},transferMacroData:function(t){this.getSinglePageAsserts().filter(function(e){return-1!==t.subject.indexOf(e.subject[0])}).forEach(function(e){"string"!=typeof e.result.description&&(e.result.description=""),""===e.result.description.trim()?e.result.description=t.result.description.trim():e.result.description=(t.result.description+"\n\n"+e.result.description).trim(),e.result.outcome=t.result.outcome})},setCaseForEachPage:function(){var t,r=this;t=this.hasPart.filter(function(e){return angular.isArray(e.subject)&&1===e.subject.length}).map(function(e){return e.subject[0]}),e.getPages().filter(function(e){return-1===t.indexOf(e)}).forEach(function(e){r.addTestCaseAssertion({subject:[e]})})},getSpec:function(){return r.getCriterion(this.test)}},i.isDefined=function(e){return e.hasPart.reduce(function(e,t){return!(!e&&!t.isDefined())},!1)||!!e.result.description||e.result.outcome!==n.EARL.OUTCOME.UNTESTED},i.updateMetadata=function(e){e.assertedBy=a.id,e.mode=n.EARL.MODE.MANUAL,e.result.date=t("date")(Date.now(),"yyyy-MM-dd HH:mm:ss Z")},i}]),angular.module("wcagReporter").service("TestCaseAssert",["types","evalSampleModel","currentUser",function(e,r,t){var n={type:e.EARL.RESULT.class,description:"",outcome:e.EARL.OUTCOME.UNTESTED};function o(){for(var e in o.prototype)this.hasOwnProperty(e)||(this[e]=o.prototype[e]);this.subject=[],this.result=angular.copy(n)}return o.isDefined=function(e){var t=!1;return e.subject.forEach(function(e){t=t||e.title||e.description}),(e.result.description||e.result.outcome!==n.outcome)&&t},o.prototype={type:"Assertion",assertedBy:t.id,subject:void 0,testCase:void 0,result:void 0,multiPage:!1,mode:e.EARL.MODE.MANUAL,isDefined:function(){return o.isDefined(this)},addNewPage:function(e){this.subject.push(e)},removePage:function(e){this.subject.splice(e,1)},setSubject:function(e){var t=[];this.subject=t,e&&!angular.isArray(e)&&(e=[e]),e.forEach(function(e){"string"==typeof e&&(e=r.getPageById(e)),"object"==typeof e&&t.push(e)})}},o}]),angular.module("wcagReporter").service("Page",["$filter",function(r){var t=r("translate");function e(){this.type=["TestSubject","WebPage"]}return e.updateSource=function(e){var t=r("getUrl")(e.description);return t?e.source=t:delete e.source,t},e.prependProtocol=function(e){e.description&&e.description.match(/^([\da-z\.-]+)\.([a-z\.]{2,6})/)&&(e.description="http://"+e.description)},e.openInWindow=function(e,t){t=t||"_blank",e.source&&window.open(e.source,t)},e.prototype={type:["TestSubject","WebPage"],id:"",description:void 0,title:"",tested:!1,selected:!1,displayTitle:function(){var e=0;return this.title.trim()?this.title:"_:struct_"===this.id.substr(0,9)?(e=+this.id.substr(9),t("SAMPLE.STRUCTURED_PAGE")+" "+(e+1)):"_:rand_"===this.id.substr(0,7)?(e=+this.id.substr(7),t("SAMPLE.RANDOM_PAGE")+" "+(e+1)):t("SAMPLE.SAMPLE_PAGE")}},e}]),angular.module("wcagReporter").service("evalScopeModel",function(){var t={type:"EvaluationScope",wcagVersion:"WCAG21",conformanceTarget:"wai:WCAG2AA-Conformance",additionalEvalRequirement:"",website:{type:["TestSubject","WebSite"],id:"_:website",siteName:"",siteScope:""},accessibilitySupportBaseline:"",exportData:function(){return{type:t.type,conformanceTarget:t.conformanceTarget,additionalEvalRequirement:t.additionalEvalRequirement,website:{type:t.website.type,id:t.website.id,siteName:t.website.siteName,siteScope:t.website.siteScope},accessibilitySupportBaseline:t.accessibilitySupportBaseline}},wcagVersionOptions:["WCAG21","WCAG20"],conformanceOptions:["wai:WCAG2A-Conformance","wai:WCAG2AA-Conformance","wai:WCAG2AAA-Conformance"],validate:function(){return[]},matchConformTarget:function(e){return t.conformanceTarget.length>=e.length}};return Object.preventExtensions(t.website),Object.preventExtensions(t),t}),angular.module("wcagReporter").service("currentUser",function(){return{"@context":{"@vocab":"http://xmlns.com/foaf/0.1/",id:"@id",type:"@type"},id:"_:evaluator",type:"Person",name:""}}),angular.module("wcagReporter").service("evalExploreModel",["knownTech","evalSampleModel",function(e,t){var r={knownTech:e},n=["reliedUponTechnology","essentialFunctionality","pageTypeVariety","commonPages","otherRelevantPages"];return n.forEach(function(e){r[e]=void 0}),r.reliedUponTechnology=[],r.importData=function(t){angular.isArray(t.reliedUponTechnology)||(t.reliedUponTechnology=[t.reliedUponTechnology]),n.forEach(function(e){t[e]&&(r[e]=t[e])})},r.exportData=function(){var t={};return n.forEach(function(e){t[e]=r[e]}),t},r.validate=function(){return[]},Object.preventExtensions(r),r}]),angular.module("wcagReporter").service("evalSampleModel",["Page",function(n){var o=angular,a={};function i(e){var t;return o.isArray(e.webpage)&&0!==e.webpage.length?(t=e===a.randomSample?"_:rand_":"_:struct_",e.webpage.map(function(e){return+e.id.substr(t.length)}).sort(function(e,t){return e-t}).pop()+1):0}return a.structuredSample={webpage:[]},a.randomSample={webpage:[]},a.removePage=function(e,t){var r;return o.isNumber(t)||(t=e.webpage.indexOf(t)),o.isNumber(t)&&0<=t&&(r=e.webpage.splice(t,1)[0]),r},a.addNewStructuredPage=function(){var e=a.structuredSample,t=new n,r=i(e);return e.webpage.push(t),t.id="_:struct_"+r,t.title="",t},a.addNewRandomPage=function(){var e=new n,t=i(a.randomSample);return a.randomSample.webpage.push(e),e.id="_:rand_"+t,e.title="",e},a.addNewPage=function(e){return e===a.randomSample?a.addNewRandomPage():a.addNewStructuredPage()},a.getPageByTitle=function(t){var r;return a.getPages().forEach(function(e){e.title===t&&(r=e)}),r},a.getPages=function(){return a.structuredSample.webpage.concat(a.randomSample.webpage)},a.getFilledPages=function(){return a.getPages().filter(function(e){return e.description||e.title})},a.getSelectedPages=function(){return a.getPages().reduce(function(e,t){return t.selected&&e.push(t),e},[])},a.validate=function(){return[]},a.exportData=function(){var e,n=["type","id","description","source","title","tested"];return{structuredSample:{webpage:(e=[a.structuredSample.webpage,a.randomSample.webpage].map(function(e){return e.map(function(t){var r={};return n.forEach(function(e){r[e]=t[e]}),r})}))[0]},randomSample:{webpage:e[1]}}},a.importData=function(t){["structuredSample","randomSample"].forEach(function(e){a[e]=t[e],"object"!=typeof t[e]&&(a[e]={}),void 0===a[e].webpage?a[e].webpage=[]:o.isArray(a[e].webpage)||(a[e].webpage=[a[e].webpage]),a[e].webpage.forEach(function(e){e.displayTitle=n.prototype.displayTitle})})},a.getPageById=function(e){for(var t=a.getPages(),r=0;r<t.length;r++)if(t[r].id===e)return t[r]},Object.preventExtensions(a),a}]),angular.module("wcagReporter").service("evalAuditModel",["TestCaseAssert","evalScopeModel","wcag2spec","CriterionAssert","types","$filter",function(r,e,t,n,a,i){var o,s={};return t.onLangChange(function(){t.getCriteria().forEach(function(e){void 0===s[e.id]&&o.addCritAssert({test:e.id})})}),o={criteria:s,exportData:function(){var e=angular.copy(o.getCriteriaSorted());return e.reduce(function(e,t){return t.hasPart=t.hasPart.filter(function(e){return r.isDefined(e)}),Object.keys(t).forEach(function(e){"function"==typeof t[e]&&delete t[e]}),e.push.apply(e,t.hasPart),e},[]).forEach(function(e){e.subject=e.subject.map(function(e){return e.id})}),e},importData:function(e){e.auditResult&&(angular.isArray(e.auditResult)||(e.auditResult=[e.auditResult]),e.auditResult.forEach(o.addCritAssert))},getCritAssert:function(e){if("object"!=typeof s[e])throw new Error("Unknown criterion of id "+e);return s[e]},getCriteriaSorted:function(){return t.isLoaded()?t.getCriteria().map(function(e){return s[e.id]}).filter(angular.isDefined):[]},addCritAssert:function(e){var t,r=Object.create(n.prototype);for(t in n.apply(r),e)"hasPart"===t?(angular.isArray(e.hasPart)||(e.hasPart=[e.hasPart]),e.hasPart.forEach(r.addTestCaseAssertion,r)):r[t]=e[t];s[r.test]=r},updateCritAssert:function(e,t){if(void 0!==t&&"object"==typeof t){var r=o.getCritAssert(e);t.result&&function(e,t){var r,n,o=t.result;e.result.description+=(r=o,n="\n\n",n+="*Imported finding*",n+="\noutcome: "+i("rdfToLabel")(r.outcome),r.description&&(n+="\n"+r.description),n),e.result.description=e.result.description.replace(/^\s+/,""),e.result.outcome!==a.EARL.OUTCOME.FAILED&&o.outcome===a.EARL.OUTCOME.FAILED&&(e.result.outcome=a.EARL.OUTCOME.FAILED)}(r,t)}},addPageForAsserts:function(t){Object.keys(s).forEach(function(e){s[e].addPage(t)})},removePageFromAsserts:function(t){Object.keys(s).forEach(function(e){s[e].removePage(t)})}}}]),angular.module("wcagReporter").service("evalReportModel",["$filter","currentUser",function(e,t){var r={creator:t,title:"",summary:"",specifics:"",commissioner:""},n=Object.create(r);return r.date=e("date")(new Date,"longDate"),n.exportData=function(){var e=angular.copy(n);return e.creator=e.creator.id,e},n.importData=function(t){Object.keys(r).forEach(function(e){angular.isDefined(t[e])&&(n[e]=t[e])})},n.setDefaultTitle=function(e){n.title||(n.title=e)},n}]),angular.module("wcagReporter").factory("evalModel",["evalScopeModel","evalExploreModel","evalSampleModel","evalAuditModel","evalReportModel","evalContextV3","currentUser",function(e,t,r,n,o,a,i){return{id:void 0,type:"Evaluation",context:a,scopeModel:e,exploreModel:t,sampleModel:r,auditModel:n,reportModel:o,otherData:[i]}}]),angular.module("wcagReporter").factory("wcagReporterImport",["$rootScope","evalModel","currentUser","reportStorage","importV1","changeLanguage",function(n,s,l,e,r,o){var c=window.jsonld;function a(e){e.evaluationScope&&function(t,r){Object.keys(t).forEach(function(e){"function"!=typeof t[e]&&void 0!==r[e]&&(t[e]=r[e])})}(s.scopeModel,e.evaluationScope),s.id=e.id,s.type=e.type,s.sampleModel.importData(e),s.reportModel.importData(e),s.auditModel.importData(e),s.exploreModel.importData(e),s.otherData=e.otherData}var i={storage:e,fromJson:function(e){i.fromObject(angular.fromJson(e))},getFromUrl:function(){return e.get().then(function(e){return i.fromJson(e),e})},fromObject:function(e){var t=e["@graph"]||null;angular.isArray(t)&&!r.isLatestVersion(t)&&(e["@graph"]=r(t)),c.expand(e,function(e,t){e&&console.error(e),i.fromExpanded(t)})},fromExpanded:function(e){e.forEach(function(r){var n=[],o=0,t=s.context["@vocab"]+s.type,a=l["@context"]["@vocab"]+l.type;function i(e,t){e?console.error(e):(n.push(t),n.length===o&&r(n))}return function(e){o+=1,e["@type"]&&-1!==e["@type"].indexOf(t)?c.compact(e,s.context,i):e["@type"]&&-1!==e["@type"].indexOf(a)?c.compact(e,l["@context"],i):n.push(e)}}(function(e){var r=e.reduce(function(e,t){if("Evaluation"!==t.type)return e;if(void 0!==e)throw new Error("Only one evaluation object allowed in JSON data");return t},void 0);if(!r)throw new Error("No evaluation found in data");"string"==typeof r.creator&&0===r.creator.indexOf("_:")&&(l.id=r.creator),r.creator=l;var t=!1;e.forEach(function(e){t||"Person"!==e.type||e.id!==l.id||(angular.extend(l,e),t=!0)}),r.otherData=e.reduce(function(e,t){return t!==r&&t.id!==l.id&&e.push(t),e},[l]),r.lang&&(angular.isArray(r.lang)&&(r.lang=r.lang.join("")),o(r.lang)),n.$apply(function(){a(r)})}))}};return i}]),angular.module("wcagReporter").factory("importV1",["types","wcagSpecIdMap","evalContextV1","evalContextV2","evalContextV3","$filter",function(n,o,r,a,i,e){var s=e("getUrl");function t(e){return e.map(function(e){return c(e)&&(e=p(e)),d(e)&&(e=g(e)),"object"==typeof e&&"object"==typeof e["@context"]&&"http://xmlns.com/foaf/spec/#"===e["@context"]["@vocab"]&&(e["@context"]["@vocab"]="http://xmlns.com/foaf/0.1/"),e})}function l(e){var t=e.split(":"),r=o.filter(function(e){return 0<=e.indexOf(t[1])})[0],n=r.length-1;return t[1]=r[n].toString(),t.join(":")}function c(e){if("object"!=typeof e)throw new TypeError("Expected data to be of type object but is "+typeof e+" instead.");var t=e["@context"];return"object"==typeof t&&m(t,r)}function u(e){"webpage"===e.type&&(e.type=["TestSubject","WebPage"]),e.title=e.handle,delete e.handle;var t=s(e.description);t&&(e.source=t)}function p(e){var t=angular.copy(e);t["@context"]=a,t.type="Evaluation";var r=t.evaluationScope;return r.type=r.type||"EvaluationScope",r.website.type=r.website.type||["TestSubject","WebSite"],t.reliedUponTechnology.forEach(function(e){e.type=e.type||"Technology"}),"wcag20:level_"===r.conformanceTarget.substr(0,13)&&(r.conformanceTarget="wai:WCAG2"+r.conformanceTarget.replace("wcag20:level_","").toUpperCase()+"-Conformance"),r.website.title&&(r.website.siteName=r.website.title,delete r.website.title),angular.isArray(t.structuredSample.webpage)||(t.structuredSample.webpage=[t.structuredSample.webpage]),t.structuredSample.type=t.structuredSample.type||"Sample",t.structuredSample.webpage.forEach(u),angular.isArray(t.randomSample.webpage)||(t.randomSample.webpage=[t.randomSample.webpage]),t.randomSample.type=t.randomSample.type||"Sample",t.randomSample.webpage.forEach(u),t.auditResult.forEach(function e(t){t.type=t.type.replace("earl:assertion","Assertion"),t.testRequirement?(t.test=t.testRequirement.replace("wcag20:","WCAG2:"),delete t.testRequirement):t.testcase&&(t.test=t.testcase.replace("wcag20:","WCAG2:"),delete t.testcase),t.result.type!==n.EARL.RESULT.class&&(t.result.type=n.EARL.RESULT.class),t.mode!==n.EARL.MODE.MANUAL&&(t.mode=n.EARL.MODE.MANUAL),t.hasPart&&t.hasPart.forEach(e)}),t}function d(e){if("object"!=typeof e)throw new TypeError("Expected object but got "+typeof e);return!!Object.prototype.hasOwnProperty.call(e,"@context")&&(e["@context"]===a||m(e["@context"],a))}function g(e){var t=angular.copy(e);return t["@context"]=i,t.auditResult.forEach(function(e){e.test&&(e.test=l(e.test)),e.hasPart&&e.hasPart.length&&e.hasPart.forEach(function(e){e.test&&(e.test=l(e.test))})}),t}function f(e){if("object"!=typeof e)throw new TypeError("Expected object but got "+typeof e);return!!Object.prototype.hasOwnProperty.call(e,"@context")&&e["@context"]===i}function m(e,t){var r=!0;for(var n in t){if(!Object.prototype.hasOwnProperty.call(e,n)){r=!1;break}if("object"==typeof e[n]&&!m(e[n],t[n])){r=!1;break}if("string"==typeof e[n]&&e[n]!==t[n]){r=!1;break}}return r}return t.isLatestVersion=f,t.isV1Evaluation=c,t.isV2Evaluation=d,t.isV3Evaluation=f,t.upgradeToV2=p,t.upgradeToV3=g,t}]),angular.module("wcagReporter").factory("wcagReporterExport",["evalModel","reportStorage","pkgData","$rootScope",function(r,e,t,n){var o={storage:e,saveToUrl:function(){return e.post(o.getJson())},getJson:function(){return{"@graph":[function(){var e={"@context":r.context,type:r.type,id:r.id,publisher:"reporter:releases/tag/"+t.version,lang:n.lang};return e.evaluationScope=r.scopeModel.exportData(),e.auditResult=r.auditModel.exportData(),angular.extend(e,r.reportModel.exportData(),r.sampleModel.exportData(),r.exploreModel.exportData()),e}()].concat(r.otherData)}},getString:function(){return angular.toJson(o.getJson(),!0)},getBlobUrl:function(e){try{return e=e||o.getBlob(),(window.URL||window.webkitURL).createObjectURL(e)}catch(e){console.error(e)}},saveBlobIE:function(e,t){e=e||o.getBlob(),t=t||o.getFileName(),window.navigator.msSaveOrOpenBlob&&window.navigator.msSaveBlob(e,t)},getBlob:function(e,t){return e=e||o.getString(),t=t||"application/json;charset=utf-8",new Blob([e],{type:t})},getFileName:function(e){var t=r.scopeModel.website.siteName+" evaluation report";return e=e||"json",(t=t.trim()).replace(/(^\-+|[^a-zA-Z0-9\/_| -]+|\-+$)/g,"").toLowerCase().replace(/[\/_| -]+/g,"-")+"."+e}};return e.exportModel=o}]),angular.module("wcagReporter").controller("FooterCtrl",["$scope","pkgData",function(e,t){e.pkg=t}]),angular.module("wcagReporter").controller("NavigationCtrl",["$scope","$rootScope","supportedLanguages","changeLanguage",function(r,e,t,n){r.languages=t,r.currentLang=e.lang,e.$on("$translateChangeSuccess",function(e,t){r.currentLang=t.language.toLowerCase()}),r.changeLanguage=n}]),angular.module("wcagReporter").controller("StartCtrl",["$scope","$location","appState","$timeout","$rootScope",function(e,t,r,n,o){e.state=r.moveToState("start"),void 0===o.rootHide.start1&&(e.initial="hidden",n(function(){e.initial=""},500),n(function(){o.rootHide.start1=!1},700)),e.nextStep=function(){t.path("/evaluation/scope")},e.nextStepName="STEP_SCOPE"}]),angular.module("wcagReporter").controller("StepButtonsCtrl",["$scope","$location","appState",function(e,t,r){var n=r.getPreviousState(),o=r.getNextState();o&&(e.nextStep=function(){t.path(o.route)},e.nextStepName="STEP_"+o.name.toUpperCase()),n&&(e.previousStep=function(){t.path(n.route)},e.previousStepName="STEP_"+n.name.toUpperCase())}]),angular.module("wcagReporter").controller("EvalScopeCtrl",["$scope","appState","evalScopeModel","evalReportModel","$filter",function(e,t,r,n,o){e.state=t.moveToState("scope"),e.scopeModel=r,e.wcagVersionOptions=r.wcagVersionOptions.reduce(function(e,t){var r="SCOPE."+t;return e[t]=o("translate")(r),e},{}),e.conformanceOptions=r.conformanceOptions.reduce(function(e,t){return e[t]=o("rdfToLabel")(t),e},{}),e.$on("$routeChangeStart",function(){if(r.website.siteName){var e=o("translate")("REPORT.TITLE_PREFIX")+" "+r.website.siteName;n.setDefaultTitle(e)}})}]),angular.module("wcagReporter").controller("EvalExploreCtrl",["$scope","appState","$timeout","evalExploreModel",function(o,e,a,i){o.state=e.moveToState("explore"),o.exploreModel=i,o.updateSpec=function(e){t[e.title]&&(e.id=t[e.title])},o.knownTech=angular.copy(i.knownTech),o.otherTech=[],i.reliedUponTechnology.forEach(function(n){var e=o.knownTech.reduce(function(e,t,r){return t.id===n.id&&t.title===n.title?r:e},-1);-1!==e?o.knownTech[e].checked=!0:o.otherTech.push(n)}),0===o.otherTech.length?o.otherTech.push({type:"Technology"}):o.rootHide.OtherTech=o.rootHide.OtherTech||!0,o.changeTech=function(t){if(t.checked){var e=angular.extend({},t);delete e.checked,i.reliedUponTechnology.push(e)}else i.reliedUponTechnology=i.reliedUponTechnology.filter(function(e){return e.title!==t.title&&e.id!==t.id})},o.updateOtherTech=function(e){var t=i.reliedUponTechnology.indexOf(e),r=!e.title&&!e.id;-1!==t||r?-1!==t&&r&&i.reliedUponTechnology.splice(t,1):i.reliedUponTechnology.push(e)},o.addTechnology=function(e){if(o.otherTech.push({type:"Technology"}),e){var t=angular.element(e.delegateTarget);a(function(){var e=t.prev().find("input");0<e.length&&e[0].select()})}},o.removeTechnology=function(e,t){var r=o.otherTech[e],n=i.reliedUponTechnology.indexOf(r);i.reliedUponTechnology.splice(n,1),o.otherTech.splice(e,1),t&&a(function(){angular.element(t.delegateTarget).closest("fieldset").parent().children().last().focus()})};var t={};o.knownTech.forEach(function(e){t[e.title]=e.id})}]),angular.module("wcagReporter").controller("EvalSampleCtrl",["$scope","appState","evalExploreModel","evalSampleModel","evalAuditModel",function(a,e,t,i,s){if(a.state=e.moveToState("sample"),a.structuredSample=i.structuredSample,a.randomSample=i.randomSample,a.exploreModel=t,a.structuredSample&&0===a.structuredSample.webpage.length){var r=i.addNewStructuredPage();if(s.addPageForAsserts(r),a.randomSample&&0===a.randomSample.webpage.length){var n=i.addNewRandomPage();s.addPageForAsserts(n)}}a.getPageAdder=function(o){return function(){var e=i.addNewPage(o);s.addPageForAsserts(e);var t=a.structuredSample.webpage.length,r=Math.ceil(t/10);if(a.randomSample.webpage.length+1===r&&t%10==1){var n=i.addNewPage(a.randomSample);s.addPageForAsserts(n)}return e}},a.getPageRemover=function(r){return function(e){var t=i.removePage(r,e);s.removePageFromAsserts(t)}},a.randPageCount=function(){return Math.ceil(a.structuredSample.webpage.length/10)}}]),angular.module("wcagReporter").controller("EvalAuditCtrl",["$scope","appState",function(e,t){e.state=t.moveToState("audit")}]),angular.module("wcagReporter").controller("AuditCriteriaCtrl",["$scope","evalAuditModel","evalScopeModel","wcag2spec","$rootElement","$anchorScroll","$filter","$rootScope","$timeout",function(o,n,e,t,r,a,i,s,l){var c=[],u=[];function p(e,t){var r=t[e.length];e.push(r),e.length!==t.length&&l(function(){p(e,t)},50)}function d(){u=function(){var e=o.critFilter,t=[];for(var r in e){if(Object.prototype.hasOwnProperty.call(o.critFilter,r)&&"object"==typeof e[r])for(var n in e[r])Object.prototype.hasOwnProperty.call(e[r],n)&&!0===e[r][n]&&t.push(n);Object.prototype.hasOwnProperty.call(o.critFilter,r)&&"string"==typeof e[r]&&e[r].split(" ").forEach(function(e){t.push(e)})}return t.slice()}()}function g(e){var t=-1!==u.indexOf(e.versions[0]),r=-1!==u.indexOf(e.level);return t&&r||t&&!function(){var e=o.critFilter.levels;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&!0===e[t])return!0;return!1}()}o.criteria=n.getCriteriaSorted(),o.getCritAssert=n.getCritAssert,o.principles=[],t.isLoaded()&&(c=t.getPrinciples(),p(o.principles,c)),o.$on("wcag2spec:langChange",function(){c=t.getPrinciples(),o.principles=[],p(o.principles,c)}),o.handleFilterChange=function(){d()},s.rootHide.criteria?o.critFilter=s.rootHide.criteria:(o.critFilter={version:"WCAG21"===e.wcagVersion?"WCAG21 WCAG20":"WCAG20",levels:{"wai:WCAG2A-Conformance":e.matchConformTarget("wai:WCAG2A-Conformance"),"wai:WCAG2AA-Conformance":e.matchConformTarget("wai:WCAG2AA-Conformance"),"wai:WCAG2AAA-Conformance":e.matchConformTarget("wai:WCAG2AAA-Conformance")}},s.rootHide.criteria=o.critFilter),d(),o.isCriterionVisible=function(e){return!!g(e)},o.isGuidelineVisible=function(e){return e.successcriteria.some(function(e){return o.isCriterionVisible(e)})},o.isPrincipleVisible=function(e){return e.guidelines.some(function(e){return o.isGuidelineVisible(e)})};var f=["earl:untested","earl:cantTell"];o.criteriaUntested=function(e){var r=0;return e.successcriteria.forEach(function(e){var t=n.getCritAssert(e.id);-1!==f.indexOf(t.result.outcome)&&(r+=1)}),r},o.toTop=function(){$("html, body").animate({scrollTop:r.offset().top},200,r.focusH1)}}]),angular.module("wcagReporter").controller("AuditSamplePagesCtrl",["$scope","evalSampleModel","Page","$rootScope",function(s,l,t,r){var c,n=l.getSelectedPages,e=l.getPages;s.structuredSample=l.structuredSample,s.randomSample=l.randomSample,s.filledPages=function(){return l.getFilledPages()},s.auditSize=n.length,s.anySelect=0!==s.auditSize,s.openSelected=function(){n().forEach(function(e){t.openInWindow(e)})},s.openPage=t.openInWindow,s.changeAll=function(){e().forEach(function(e){e.selected=s.anySelect}),s.sampleChange()},s.multiSelect=function(e,t){if("input"===t.toElement.nodeName.toLowerCase()){if(void 0!==c&&t.shiftKey){for(var r=l.getFilledPages(),n=Math.min(c,e),o=Math.max(c,e),a=r[e].selected,i=n;i<=o;i++)r[i].selected=a;s.sampleChange()}c=e}},s.sampleChange=function(){var e=n().length;s.auditSize=e,s.anySelect=0<e,r.$broadcast("audit:sample-change")},s.completePages=function(){n().forEach(function(e){e.tested=!0})},s.uncompletePages=function(){n().forEach(function(e){e.tested=!1})}}]),angular.module("wcagReporter").controller("EvalReportCtrl",["$scope","appState","evalReportModel",function(e,t,r){e.state=t.moveToState("report"),e.reportModel=r}]),angular.module("wcagReporter").controller("ViewReportCtrl",["$scope","$document","wcag2spec","evalModel","appState","wcagReporterExport","toggleCriterionText",function(e,n,t,r,o,a,i){var s;e.state=o.moveToState("viewReport"),e.scope=r.scopeModel,e.explore=r.exploreModel,e.filledPages=function(){return r.sampleModel.getFilledPages()},e.wcag2specReady=t.isLoaded(),e.$on("wcag2spec:langChange",function(){e.wcag2specReady=!0}),e.report=r.reportModel;var l=['<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>'+r.reportModel.title+"</title><script>"+i.toString().replace("function (a)","function toggleCriterionText(a)")+'<\/script><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" /><link rel="stylesheet" href="report.css" /></head><body><div class="container reporter-view">',"</div></body></html>"];e.$on("reportReady",function(e,t){var r=l[0]+t.html()+l[1];s=a.getBlob(r,"text/html;charset=utf-8"),n.find("#html_download_link").attr("href",a.getBlobUrl(s))}),e.downloadJsonStart=function(){a.saveBlobIE(),o.setPrestineState()},e.saveHtmlBlobIE=function(){s&&a.saveBlobIE(s,e.exportHtmlFile)},e.exportHtmlFile=a.getFileName("html"),e.exportJsonUrl=a.getBlobUrl(),e.exportJsonFile=a.getFileName()}]),angular.module("wcagReporter").controller("OpenCtrl",["$scope","reportStorage","evalLoader","$rootScope",function(t,e,r,n){function o(e,t){t.posted=!0,t.failure=!1,e.then(function(){t.posted=!1,n.setEvalLocation()},function(e){t.posted=!1,e.message?t.failure=e.message:t.failure=e})}t.postSettings=e.settings,t.fileFeedback={posted:!1,failures:!1},t.evalFile="",t.urlFeedback={posted:!1,failures:!1},t.loadFile=function(e){o(r.openFromFile(e),t.fileFeedback)},t.loadUrl=function(){o(r.openFromUrl(t.postSettings.url),t.urlFeedback)},t.updateSettings=function(){e.updateSettings()}}]),angular.module("wcagReporter").controller("ImportCtrl",["fileReader","$scope","$rootScope","evalContextV3","evalModel","types","isObjectLiteral","wcagSpecIdMap",function(t,f,e,n,m,v,h,o){var a=window.jsonld,w={type:"error",class:"danger"},r={type:"pending",class:"info"},b={type:"success",class:"success"};function y(e){var t=e.split(":")[1];return o.some(function(e){return 0<=e.indexOf(t)})}function S(e,t){"WCAG2"!==t.split(":")[0]&&(t=function(e){var t=e.split(":")[1],r=o.filter(function(e){return 0<=e.indexOf(t)})[0];return"WCAG2:"+r[r.length-1]}(t)),e.wcagId=t}f.assertionImport=[],f.allowedMime=["application/json","application/ld+json"].join(","),f.feedback=!1,f.importFile=void 0,f.importConfirmed=void 0,f.loadFile=function(e){if(f.feedback=r,!function(e){return 0<=f.allowedMime.indexOf(e.type)}(e))return f.feedback=w,f.feedback.message="Expected to open a json-file, the filename must end with either â€œ.jsonâ€ or â€œ.jsonldâ€.",void f.$apply();f.importFile={name:e.name},function(e,g){e.then(function(e){var t=JSON.parse(e),r=angular.copy(n);r.WCAG20="https://www.w3.org/TR/WCAG20/#",r.isPartOf={"@id":"dct:isPartOf","@type":"@id"},a.frame(t,{"@context":r,"@graph":[{"@type":"Assertion"}]},function(e,t){if(e)(g=w).message=e.message;else{for(var r,n,o,a,i,s,l,c,u=t["@graph"],p=u.length,d=0;d<p;d++)r=u[d],c=l=s=i=a=o=void 0,function(e){var t,r=Object.keys(e),n=["test","subject","result","assertedBy"];for(t in n)if(-1===r.indexOf(n[t]))return!1;return!0}(n=r)&&function(e){var t=m.sampleModel.getPages().map(function(t){var e;if(void 0!==t.source){try{e=new URL(t.source)}catch(e){return console.error(e),t.source}return e.href}}),r="";if("string"==typeof e)try{r=new URL(e).href}catch(e){return console.error("Expected valid url in import assertion subject."),!1}if(h(e)&&void 0!==e.source)try{r=new URL(e.source).href}catch(e){return console.error("Expected valid url in import assertion subject."),!1}return 0<=t.indexOf(r)}(n.subject)&&("string"==typeof(o=n.test)&&y(o)||(h(o)&&void 0!==o.id&&y(o.id)?(S(n,o.id),1):h(o)&&void 0!==o.isPartOf&&"string"==typeof o.isPartOf&&y(o.isPartOf)&&(S(n,o.isPartOf),1)))&&(c=n.result,a=c,i=v.EARL.OUTCOME,s=[i.PASSED,i.FAILED,i.CANT_TELL,i.INAPPLICABLE,i.UNTESTED],l=[i.PASS,i.FAIL,i.CANNOT_TELL,i.NOT_APPLICABLE,i.NOT_TESTED],void 0!==a.outcome&&("string"==typeof a.outcome&&0<=s.indexOf(a.outcome)||h(a.outcome)&&void 0!==a.outcome["@type"]&&0<=l.indexOf(a.outcome["@type"])))&&f.assertionImport.push(r);0<f.assertionImport.length?f.feedback={type:b.type,message:"Ready to import "+f.assertionImport.length+" assertions."}:(f.feedback={type:w.type,message:"No Assertions found in file â€œ"+f.importFile.name+"â€"},f.importFile=null),f.$apply()}})},function(e){g=w,e.message?g.message=e.message:g.message=e})}(t.readAsText(e,f),f.feedback)},f.handleConfirmation=function(e){void 0===e&&(e=!1),e?(f.feedback=r,f.feedback.message="Inserting "+f.assertionImport.length+" assertions from â€œ"+f.importFile.name+"â€",function(){for(var e,t,r,n=f.assertionImport,o=n.length,a=0;a<o;a++)e=n[a],(t="string"==typeof(r=e).test?r.test:r.wcagId||!1)&&m.auditModel.updateCritAssert(t,e);f.feedback={type:b.class,message:"Import successfull! Imported "+o+" assertions."}}(),f.importConfirmed=e):(f.feedback=!1,f.importFile=void 0,f.importConfirmed=void 0,f.assertionImport.length=0,f.feedback=r,f.feedback.message="Import aborted. Choose another file or go back to the evaluation.")},f.handleDoneClick=function(){e.setEvalLocation()}}]),angular.module("wcagReporter").controller("SaveCtrl",["$scope","wcagReporterExport","appState",function(t,e,r){t.exportUrl=e.getBlobUrl(),t.exportFile=e.getFileName(),t.postSettings=e.storage.settings,t.posted=!1,t.failure=!1,t.success=!1,t.postJson=function(){t.posted=!0,t.failure=!1,e.saveToUrl().then(function(){t.success=!0,t.posted=!1},function(e){t.failure=e||!0,t.posted=!1})},t.downloadStart=function(){e.saveBlobIE(),r.setPrestineState()},t.updateSettings=function(){e.storage.updateSettings()}}]),angular.module("wcagReporter").controller("ReportScoreCtrl",["$scope","wcag2spec","evalAuditModel",function(a,e,i){a.principles=e.getPrinciples();var s={"earl:passed":0,"earl:failed":0,"earl:inapplicable":0,"earl:untested":0,"earl:cantTell":0,level_a:{pass:0,total:0},level_aa:{pass:0,total:0},level_aaa:{pass:0,total:0}};a.totals=s,a.getScores=function(){return e.getPrinciples().map(function(e){var o={name:e.num+". "+e.handle,"earl:passed":0,"earl:failed":0,"earl:inapplicable":0,"earl:untested":0,"earl:cantTell":0,tested:0,level_a:{pass:0,total:0},level_aa:{pass:0,total:0},level_aaa:{pass:0,total:0}};return e.guidelines.reduce(function(e,t){return e.push.apply(e,t.successcriteria),e},[]).forEach(function(e){var t=i.getCritAssert(e.id);if(t){var r=t.result.outcome,n=e.level.replace("wai:WCAG2","").replace("-Conformance","").toLowerCase();o[r]+=1,a.totals[r]+=1,"earl:passed"!==r&&"earl:inapplicable"!==r||(o["level_"+n].pass+=1,s["level_"+n].pass+=1),"earl:untested"!==r&&(o.tested+=1,o["level_"+n].total+=1,s["level_"+n].total+=1)}}),o})},a.scores=a.getScores(),a.$on("wcag2spec:langChange",function(){a.scores=a.getScores()})}]),angular.module("wcagReporter").controller("ReportFindingsCtrl",["$scope","wcag2spec","evalAuditModel","evalScopeModel","CriterionAssert",function(r,e,t,n,o){e.isLoaded()?r.principles=e.getPrinciples():(r.principles=[],e.onLangChange(function(){r.principles=e.getPrinciples()})),r.auditModel=t,r.critOpt={editable:!1,collapsed:!1,showallpages:!1,hideCollapseBtn:!0},r.getCritAssert=t.getCritAssert,r.shouldCritRender=function(e){if(n.matchConformTarget(e.level))return!0;var t=r.getCritAssert(e.id);return o.isDefined(t)}}]);